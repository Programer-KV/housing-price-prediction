# -*- coding: utf-8 -*-
"""housing_price.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1mMGDkG54di3qEZbei-ZGQr6vYtZsNkF-
"""

import pandas as pd
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

column_names = ['CRIM','ZN','INDYS','CHAS','NOX','RM','AGE','DIS','RAD','TES','PETRIO','B','LSTAT','MEDV']
try:
  data = pd.read_csv(
      'https://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data',
      header = None,
      delimiter = r"\s+",
      names = column_names
  )
except Exception as e:
  print(f"Errorhttps loading dataset : {e}")
  print("please check your internet connection or URL.")
  exit()

print("--First five rows of the data--")
print(data.head())
print("\n")

print("--Dataset Discription--")
print(data.describe())
print("\n")

X = data[['LSTAT']]
y = data[['MEDV']]
X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2,random_state=42)

model = LinearRegression()
model.fit(X_train,y_train)
print(f"Model Intercept (b0): {model.intercept_}")
print(f"Model Coefficient for LSTAT (b1): {model.coef_[0]}\n")

y_pred = model.predict(X_test)
mse = mean_squared_error(y_test,y_pred)
print(f"Mean Squared Error on Test Data: {mse:.2f}")

plt.figure(figsize=(10,6))
plt.scatter(X_test,y_test,colorizer='blue',label='Actual Prices')
plt.plot(X_test,y_pred,color='red',linewidth=2,label='Predicted prices {Regression Line}')
plt.title('Housing Price vs. % Lower Status of Population (Test Data)')
plt.xlabel('% Lower Status of Population (LSTAT)')
plt.ylabel('Median House Price ($1000s, MEDV)')
plt.legend()
plt.grid(True)
plt.savefig('housing_price_prediction_plot.png')
plt.show()

